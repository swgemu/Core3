/*
 * StartVulnerabilityTask.h
 *
 *  Created on: Oct 26, 2012
 *      Author: root
 */

#ifndef STARTVULNERABILITYTASK_H_
#define STARTVULNERABILITYTASK_H_

#include "engine/engine.h"
#include "GCWManager.h"
#include "server/zone/objects/building/components/DestructibleBuildingDataComponent.h"

class StartVulnerabilityTask : public Task {
	ManagedWeakReference<BuildingObject*> buildingObject;
	ManagedWeakReference<GCWManager*> gcwManager;
public:
	StartVulnerabilityTask(GCWManager* gcwMan, BuildingObject* building) {
		gcwManager = gcwMan;
		buildingObject = building;
	}

	void run() {
		ManagedReference<GCWManager*> strongRefManager = gcwManager.get();
		ManagedReference<BuildingObject*> strongRefBuilding = buildingObject.get();
		if (strongRefBuilding == NULL || strongRefManager == NULL  )
			return;

		strongRefManager->initializeNewVulnerability(strongRefBuilding);
		strongRefManager->startVulnerability(strongRefBuilding);
	}
};




#endif /* STARTVULNERABILITYTASK_H_ */
