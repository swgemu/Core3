/*
 *	server/zone/objects/scene/SceneObject.h generated by engine3 IDL compiler 0.60
 */

#ifndef SCENEOBJECT_H_
#define SCENEOBJECT_H_

#include "engine/core/Core.h"

#include "engine/core/ManagedReference.h"

#include "engine/core/ManagedWeakReference.h"

namespace server {
namespace zone {
namespace managers {
namespace objectcontroller {

class ObjectController;

} // namespace objectcontroller
} // namespace managers
} // namespace zone
} // namespace server

using namespace server::zone::managers::objectcontroller;

namespace server {
namespace zone {

class ZoneProcessServer;

} // namespace zone
} // namespace server

using namespace server::zone;

namespace server {
namespace zone {

class ZoneClientSession;

} // namespace zone
} // namespace server

using namespace server::zone;

namespace server {
namespace zone {

class Zone;

} // namespace zone
} // namespace server

using namespace server::zone;

namespace server {
namespace zone {

class ZoneServer;

} // namespace zone
} // namespace server

using namespace server::zone;

namespace server {
namespace zone {
namespace objects {
namespace building {

class BuildingObject;

} // namespace building
} // namespace objects
} // namespace zone
} // namespace server

using namespace server::zone::objects::building;

namespace server {
namespace zone {
namespace packets {
namespace object {

class ObjectMenuResponse;

} // namespace object
} // namespace packets
} // namespace zone
} // namespace server

using namespace server::zone::packets::object;

namespace server {
namespace zone {
namespace objects {
namespace creature {

class CreatureObject;

} // namespace creature
} // namespace objects
} // namespace zone
} // namespace server

using namespace server::zone::objects::creature;

namespace server {
namespace zone {
namespace packets {
namespace scene {

class AttributeListMessage;

} // namespace scene
} // namespace packets
} // namespace zone
} // namespace server

using namespace server::zone::packets::scene;

namespace server {
namespace zone {
namespace templates {

class SharedObjectTemplate;

} // namespace templates
} // namespace zone
} // namespace server

using namespace server::zone::templates;

namespace server {
namespace zone {
namespace objects {
namespace area {

class ActiveArea;

} // namespace area
} // namespace objects
} // namespace zone
} // namespace server

using namespace server::zone::objects::area;

namespace server {
namespace zone {
namespace objects {
namespace creature {

class CreatureObject;

} // namespace creature
} // namespace objects
} // namespace zone
} // namespace server

using namespace server::zone::objects::creature;

#include "engine/core/ManagedObject.h"

#include "engine/util/Facade.h"

#include "server/zone/objects/scene/ObserverEventType.h"

#include "server/zone/ZoneReference.h"

#include "server/zone/objects/scene/variables/StringId.h"

#include "server/zone/objects/scene/TransferErrorCode.h"

#include "server/zone/objects/scene/variables/PendingTasksMap.h"

#include "server/zone/objects/scene/SessionFacadeType.h"

#include "server/zone/managers/templates/PlanetMapCategory.h"

#include "server/zone/managers/templates/TemplateManager.h"

#include "server/zone/objects/scene/components/ZoneComponent.h"

#include "server/zone/objects/scene/components/ObjectMenuComponent.h"

#include "server/zone/objects/scene/components/ContainerComponent.h"

#include "server/zone/objects/region/CityRegion.h"

#include "engine/log/Logger.h"

#include "engine/core/ManagedReference.h"

#include "engine/util/u3d/Coordinate.h"

#include "engine/util/u3d/QuadTreeEntry.h"

#include "system/io/Serializable.h"

#include "engine/lua/Lua.h"

#include "engine/lua/LuaObject.h"

#include "system/util/Vector.h"

#include "system/util/VectorMap.h"

#include "engine/util/u3d/Quaternion.h"

#include "engine/service/proto/BasePacket.h"

#include "engine/service/proto/BaseMessage.h"

#include "system/util/SortedVector.h"

#include "system/lang/StackTrace.h"

#include "system/lang/ref/Reference.h"

#include "engine/core/Task.h"

#include "engine/util/u3d/Vector3.h"

#include "engine/util/Observable.h"

namespace server {
namespace zone {
namespace objects {
namespace scene {

class SceneObject : public QuadTreeEntry {
public:
	static const int CELLOBJECT = 11;

	static const int PLAYEROBJECT = 12;

	static const int GROUPOBJECT = 0x02;

	static const int GUILDOBJECT = 0x03;

	static const int GENERALTANGIBLEOBJECT = 4;

	static const int STATICOBJECT = 5;

	static const int VENDORTERMINAL = 7;

	static const int ARMOR = 0x100;

	static const int BODYARMOR = 0x101;

	static const int HEADARMOR = 0x102;

	static const int MISCARMOR = 0x103;

	static const int LEGARMOR = 0x104;

	static const int ARMARMOR = 0x105;

	static const int HANDARMOR = 0x106;

	static const int FOOTARMOR = 0x107;

	static const int SHIELDGENERATOR = 0x108;

	static const int BUILDING = 0x200;

	static const int MUNICIPALBUILDING = 0x201;

	static const int FACTIONPERKBUILDING = 0x203;

	static const int TUTORIALBUILDING = 0x204;

	static const int MEDICALBUILDING = 0x205;

	static const int RECREATIONBUILDING = 0x206;

	static const int CLONINGBUILDING = 0x207;

	static const int TRAVELBUILDING = 0x208;

	static const int STARPORTBUILDING = 0x209;

	static const int CAPITOLBUILDING = 0x20A;

	static const int HOTELBUILDING = 0x20B;

	static const int THEATERBUILDING = 0x20C;

	static const int COMBATBUILDING = 0x20D;

	static const int COMMERCEBUILDING = 0x20E;

	static const int UNIVERSITYBUILDING = 0x20F;

	static const int GARAGEBUILDING = 0x210;

	static const int CITYHALLBUILDING = 0x211;

	static const int SALONBUILDING = 0x212;

	static const int CREATURE = 0x400;

	static const int NPCCREATURE = 0x401;

	static const int DROIDCREATURE = 0x402;

	static const int PROBOTCREATURE = 0x403;

	static const int PLAYERCREATURE = 0x409;

	static const int TRAINERCREATURE = 0x40A;

	static const int JUNKDEALERCREATURE = 0x40C;

	static const int INFORMANTCREATURE = 0x40D;

	static const int VENDORCREATURE = 0x40E;

	static const int INTANGIBLE = 0x800;

	static const int DRAFTSCHEMATIC = 0x801;

	static const int MANUFACTURINGSCHEMATIC = 0x802;

	static const int MISSIONOBJECT = 0x803;

	static const int TOKEN = 0x804;

	static const int WAYPOINT = 0x805;

	static const int DATA2 = 0x806;

	static const int PETCONTROLDEVICE = 0x807;

	static const int VEHICLECONTROLDEVICE = 0x808;

	static const int SHIPCONTROLDEVICE = 0x80A;

	static const int DROIDCONTROLDEVICE = 0x80B;

	static const int INSTALLATION = 0x1000;

	static const int FACTORY = 0x1001;

	static const int GENERATOR = 0x1002;

	static const int HARVESTER = 0x1003;

	static const int TURRET = 0x1004;

	static const int MINEFIELD = 0x1005;

	static const int GARAGEINSTALLATION = 0x1006;

	static const int SHUTTLEINSTALLATION = 0x1007;

	static const int TANGIBLE = 0x2000;

	static const int AMMUNITION = 0x2001;

	static const int CHEMICAL = 0x2002;

	static const int CONTAINER = 0x2005;

	static const int CRAFTINGSTATION = 0x2006;

	static const int ELECTRONICS = 0x2008;

	static const int FLORA = 0x2009;

	static const int FOOD = 0x200A;

	static const int FURNITURE = 0x200B;

	static const int INSTRUMENT = 0x200C;

	static const int PHARMACEUTICAL = 0x200D;

	static const int SIGN = 0x200F;

	static const int COUNTER = 0x2010;

	static const int FACTORYCRATE = 0x2011;

	static const int TRAVELTICKET = 0x2012;

	static const int GENERICITEM = 0x2013;

	static const int TRAP = 0x2014;

	static const int WEARABLECONTAINER = 0x2015;

	static const int FISHINGPOLE = 0x2016;

	static const int FISHINGBAIT = 0x2017;

	static const int DRINK = 0x2018;

	static const int FIREWORK = 0x2019;

	static const int ITEM = 0x201A;

	static const int PETMEDECINE = 0x201B;

	static const int FIREWORKSHOW = 0x201C;

	static const int CLOTHINGATTACHMENT = 0x201D;

	static const int LIVESAMPLE = 0x201E;

	static const int ARMORATTACHMENT = 0x201F;

	static const int COMMUNITYCRAFTINGPROJECT = 0x2020;

	static const int CRYSTAL = 0x2021;

	static const int DROIDPROGRAMMINGCHIP = 0x2022;

	static const int ASTEROID = 0x2023;

	static const int PILOTCHAIR = 0x2024;

	static const int OPERATIONSCHAIR = 0x2025;

	static const int TURRETACCESSLADDER = 0x2026;

	static const int CONTAINER2 = 0x2027;

	static const int CAMOKIT = 0x2028;

	static const int LOOTKIT = 0x2029;

	static const int FISH = 0x202A;

	static const int LAIR = 0x202B;

	static const int STIMPACK = 0x202C;

	static const int RANGEDSTIMPACK = 0x202D;

	static const int ENHANCEPACK = 0x202E;

	static const int CUREPACK = 0x202F;

	static const int DOTPACK = 0x2030;

	static const int WOUNDPACK = 0x2031;

	static const int STATEPACK = 0x2032;

	static const int REVIVEPACK = 0x2033;

	static const int STATICLOOTCONTAINER = 0x2034;

	static const int PLAYERLOOTCRATE = 0x2035;

	static const int TERMINAL = 0x4000;

	static const int BANK = 0x4001;

	static const int BAZAAR = 0x4002;

	static const int CLONING = 0x4003;

	static const int INSURANCE = 0x4004;

	static const int MISSIONTERMINAL = 0x4006;

	static const int PLAYERTERMINALSTRUCTURE = 0x4008;

	static const int SHIPPINGTERMINAL = 0x4009;

	static const int SPACETERMINAL = 0x400B;

	static const int INTERACTIVETERMINAL = 0x400C;

	static const int NEWBIETUTORIALTERMINAL = 0x400F;

	static const int CHARACTERBUILDERTERMINAL = 0x4010;

	static const int TICKETCOLLECTOR = 0x4011;

	static const int TRAVELTERMINAL = 0x4012;

	static const int ELEVATORTERMINAL = 0x4013;

	static const int GUILDTERMINAL = 0x4014;

	static const int CITYTERMINAL = 0x4015;

	static const int CITYVOTETERMINAL = 0x4016;

	static const int GAMBLINGTERMINAL = 0x4017;

	static const int TOOL = 0x8000;

	static const int CRAFTINGTOOL = 0x8001;

	static const int SURVEYTOOL = 0x8002;

	static const int REPAIRTOOL = 0x8003;

	static const int CAMPKIT = 0x8004;

	static const int SHIPCOMPONENTREPAIRITEM = 0x8005;

	static const int SLICINGTOOL = 0x8006;

	static const int MOLECULARCLAMP = 0x8007;

	static const int FLOWANALYZER = 0x8008;

	static const int LASERKNIFE = 0x8009;

	static const int WEAPONUPGRADEKIT = 0x800A;

	static const int ARMORUPGRADEKIT = 0x800B;

	static const int VEHICLE = 0x10000;

	static const int HOVERVEHICLE = 0x10001;

	static const int WEAPON = 0x20000;

	static const int MELEEWEAPON = 0x20001;

	static const int RANGEDWEAPON = 0x20002;

	static const int THROWNWEAPON = 0x20003;

	static const int HEAVYWEAPON = 0x20004;

	static const int MINE = 0x20005;

	static const int SPECIALHEAVYWEAPON = 0x20006;

	static const int ONEHANDMELEEWEAPON = 0x20007;

	static const int TWOHANDMELEEWEAPON = 0x20008;

	static const int POLEARM = 0x20009;

	static const int PISTOL = 0x2000A;

	static const int CARBINE = 0x2000B;

	static const int RIFLE = 0x2000C;

	static const int GRENADE = 0x2000E;

	static const int LIGHTNINGRIFLE = 0x2000F;

	static const int COMPONENT = 0x40000;

	static const int ARMORCOMPONENT = 0x40001;

	static const int CHEMISTRYCOMPONENT = 0x40002;

	static const int CLOTHINGCOMPONENT = 0x40003;

	static const int COMMUNITYCRAFTINGCOMPONENT = 0x40004;

	static const int DROIDCOMPONENT = 0x40005;

	static const int ELECTRONICSCOMPONENT = 0x40006;

	static const int GENETICCOMPONENT = 0x40007;

	static const int LIGHTSABERCRYSTAL = 0x40008;

	static const int MELEEWEAPONCOMPONENT = 0x40009;

	static const int MUNITIONCOMPONENT = 0x4000A;

	static const int RANGEDWEAPONCOMPONENT = 0x4000B;

	static const int STRUCTURECOMPONENT = 0x4000C;

	static const int TISSUECOMPONENT = 0x4000D;

	static const int WEAPONPOWERUP = 0x80000;

	static const int MELEEWEAPONPOWERUP = 0x80001;

	static const int RANGEDWEAPONPOWERUP = 0x80002;

	static const int THROWNWEAPONPOWERUP = 0x80003;

	static const int HEAVYWEAPONPOWERUP = 0x80004;

	static const int MINEPOWERUP = 0x80005;

	static const int SPECIALHEAVYWEAPONPOWERUP = 0x80006;

	static const int WEARABLE = 0x200000;

	static const int RING = 0x200001;

	static const int BRACELET = 0x200002;

	static const int NECKLACE = 0x200003;

	static const int EARRING = 0x200004;

	static const int RESOURCECONTAINER = 0x400000;

	static const int ENERGYGAS = 0x400001;

	static const int ENERGYLIQUID = 0x400002;

	static const int ENERGYRADIOACTIVE = 0x400003;

	static const int ENERGYSOLID = 0x400004;

	static const int INORGANICCHEMICAL = 0x400005;

	static const int INORGANICGAS = 0x400006;

	static const int INORGANICMINERAL = 0x400007;

	static const int WATER = 0x400008;

	static const int ORGANICFOOD = 0x400009;

	static const int ORGANICHIDE = 0x40000A;

	static const int ORGANICSTRUCTURAL = 0x40000B;

	static const int QUESTREOURCE = 0x40000C;

	static const int RESOURCESPAWN = 0x410000;

	static const int DEED = 0x800000;

	static const int BUILDINGDEED = 0x800001;

	static const int INSTALLATIONDEED = 0x800002;

	static const int PETDEED = 0x800003;

	static const int DROIDDEED = 0x800004;

	static const int VEHICLEDEED = 0x800005;

	static const int RESOURCEDEED = 0x800006;

	static const int CLOTHING = 0x1000000;

	static const int BANDOLIER = 0x1000001;

	static const int BELT = 0x1000002;

	static const int BODYSUIT = 0x1000003;

	static const int CAPE = 0x1000004;

	static const int CLOAK = 0x1000005;

	static const int FOOTWEAR = 0x1000006;

	static const int DRESS = 0x1000007;

	static const int HANDWEAR = 0x1000008;

	static const int EYEWEAR = 0x1000009;

	static const int HEADWEAR = 0x100000A;

	static const int JACKET = 0x100000B;

	static const int PANTS = 0x100000C;

	static const int ROBE = 0x100000D;

	static const int SHIRT = 0x100000E;

	static const int VEST = 0x100000F;

	static const int WOOKIEGARB = 0x1000010;

	static const int MISCCLOTHING = 0x1000011;

	static const int SKIRT = 0x1000012;

	static const int ITHOGARB = 0x1000013;

	static const int BADGEAREA = 0x2000000;

	static const int REGIONAREA = 0x2000001;

	static const int MISSIONSPAWNAREA = 0x2000002;

	static const int MISSIONRECONAREA = 0x2000003;

	static const int DYNAMICSPAWNAREA = 0x2000004;

	static const int STATICSPAWNAREA = 0x2000005;

	static const int GARAGEAREA = 0x2000006;

	static const int ACTIVEAREA = 0x2000007;

	static const int AIGROUP = 0x4000000;

	static const int HERDGROUP = 0x4000001;

	static const int PACKGROUP = 0x4000002;

	static const int LAIRGROUP = 0x4000003;

	static const int SHIP = 0x20000000;

	static const int SHIPFIGHTER = 0x20000001;

	static const int SHIPCAPITAL = 0x20000002;

	static const int SHIPSTATION = 0x20000003;

	static const int SHIPTRANSPORT = 0x20000004;

	static const int SHIPATTACHMENT = 0x40000000;

	static const int SHIPREACTOR = 0x40000001;

	static const int SHIPENGINE = 0x40000002;

	static const int SHIPSHIELDGENERATOR = 0x40000003;

	static const int SHIPARMOR = 0x40000004;

	static const int SHIPWEAPON = 0x40000005;

	static const int SHIPWEAPONCAPACITOR = 0x40000006;

	static const int SHIPBOOSTER = 0x40000007;

	static const int SHIPDRIODINTERFACE = 0x40000008;

	static const int SHIPCHASSIS = 0x4000000C;

	static const int SHIPMISSILE = 0x4000000D;

	static const int SHIPCOUNTERMEASURE = 0x4000000E;

	static const int SHIPWEAPONLAUNCHER = 0x4000000F;

	static const int SHIPCOUNTERMEASURELAUNCHER = 0x40000010;

	SceneObject();

	void initializePrivateData();

	void loadTemplateData(SharedObjectTemplate* templateData);

	void createComponents();

	void createContainerComponent();

	void initializeTransientMembers();

	void notifyLoadFromDatabase();

	void info(const String& msg, bool forced = false);

	void error(const String& msg);

	int inRangeObjects(unsigned int gameObjectType, float range);

	bool isInRange(SceneObject* obj, float range);

	bool addObject(SceneObject* object, int containmentType, bool notifyClient = false);

	bool removeObject(SceneObject* object, bool notifyClient = false);

	int canAddObject(SceneObject* object, int containmentType, String& errorDescription);

	void synchronizedUIListen(SceneObject* player, int value);

	void synchronizedUIStopListen(SceneObject* player, int value);

	void updateToDatabase();

	void updateToDatabaseWithoutChildren();

	void updateToDatabaseAllObjects(bool startTask);

	void destroyObjectFromDatabase(bool destroyContainedObjects = false);

	int canBeDestroyed(CreatureObject* player);

	void create(ZoneClientSession* client);

	void destroy(ZoneClientSession* client);

	void close(ZoneClientSession* client);

	void link(ZoneClientSession* client, unsigned int containmentType = 4);

	BaseMessage* link(unsigned long long objectID, unsigned int containmentType = 4);

	void sendTo(SceneObject* player, bool doClose);

	void sendWithoutParentTo(SceneObject* player);

	void sendWithoutContainerObjectsTo(SceneObject* player);

	void sendDestroyTo(SceneObject* player);

	void sendBaselinesTo(SceneObject* player);

	void sendContainerObjectsTo(SceneObject* player);

	void sendSlottedObjectsTo(SceneObject* player);

	void sendToOwner(bool doClose = true);

	void sendAttributeListTo(CreatureObject* object);

	void fillAttributeList(AttributeListMessage* msg, CreatureObject* object);

	void setCustomObjectName(const UnicodeString& name, bool notifyClient);

	void fillObjectMenuResponse(ObjectMenuResponse* menuResponse, CreatureObject* player);

	void openContainerTo(CreatureObject* player);

	void closeContainerTo(CreatureObject* player, bool notify = true);

	void insertToZone(Zone* zone);

	void insertToBuilding(BuildingObject* building);

	void switchZone(const String& newTerrainName, float newPostionX, float newPositionZ, float newPositionY, unsigned long long parentID = 0);

	void teleport(float newPositionX, float newPositionZ, float newPositionY, unsigned long long parentID = 0);

	void updateDirection(float fw, float fx, float fy, float fz);

	void notifyInsert(QuadTreeEntry* entry);

	void notifyDissapear(QuadTreeEntry* entry);

	void removeFromZone();

	void removeFromBuilding(BuildingObject* building);

	void updateZone(bool lightUpdate, bool sendPackets = true);

	void updateZoneWithParent(SceneObject* newParent, bool lightUpdate, bool sendPackets = true);

	void broadcastMessage(BasePacket* message, bool sendSelf, bool lockZone = true);

	void broadcastObject(SceneObject* object, bool sendSelf);

	void broadcastDestroy(SceneObject* object, bool sendSelf);

	void broadcastMessages(Vector<BasePacket*>* messages, bool sendSelf);

	void sendMessage(BasePacket* msg);

	int compareTo(SceneObject* obj);

	void getSlottedObjects(VectorMap<String, ManagedReference<SceneObject* > >& objects);

	unsigned long long getParentID();

	void addPendingTask(const String& name, Task* task);

	void removePendingTask(const String& name);

	Task* getPendingTask(const String& name);

	void showFlyText(const String& file, const String& uax, byte red, byte green, byte blue);

	Facade* getActiveSession(unsigned int type);

	void addActiveSession(unsigned int type, Facade* session);

	bool containsActiveSession(unsigned int type);

	bool dropActiveSession(unsigned int type);

	int getActiveSessionsCount();

	VectorMap<unsigned int, ManagedReference<Facade* > >* getObjectActiveSessions();

	int handleObjectMenuSelect(CreatureObject* player, byte selectedID);

	void notifyAddedToCloseObjects();

	void notifyRemovedFromCloseObjects();

	float getDistanceTo(SceneObject* object);

	float getDistanceTo(Coordinate* coordinate);

	void updateVehiclePosition();

	int notifyObjectInserted(SceneObject* object);

	int notifyObjectRemoved(SceneObject* object);

	bool hasNotifiedSentObject(SceneObject* object);

	int addNotifiedSentObject(SceneObject* object);

	void removeNotifiedSentObject(SceneObject* object);

	void addActiveArea(ActiveArea* area);

	void dropActiveArea(ActiveArea* area);

	bool hasActiveArea(ActiveArea* area);

	Vector<ManagedReference<ActiveArea* > >* getActiveAreas();

	int getActiveAreasSize();

	ActiveArea* getActiveRegion();

	CityRegion* getCityRegion();

	void setCityRegion(CityRegion* region);

	Zone* getZone();

	unsigned long long getObjectID();

	Vector3 getCoordinate(float distance, float angleDegrees);

	float getWorldPositionX();

	float getWorldPositionY();

	float getWorldPositionZ();

	Vector3 getWorldPosition();

	float getDirectionX();

	float getDirectionZ();

	float getDirectionY();

	float getDirectionW();

	Quaternion* getDirection();

	unsigned int getClientObjectCRC();

	unsigned int getServerObjectCRC();

	bool isWaypointObject();

	StringId* getObjectName();

	String getObjectNameStringIdFile();

	String getObjectNameStringIdName();

	String getDetailedDescription();

	int getArrangementDescriptorSize();

	String getArrangementDescriptor(int idx);

	String getSlotDescriptor(int idx);

	bool hasSlotDescriptor(const String& descr);

	VectorMap<String, ManagedReference<SceneObject* > >* getSlottedObjects();

	SceneObject* getSlottedObject(const String& slot);

	int getSlotDescriptorSize();

	SceneObject* getSlottedObject(int idx);

	void dropSlottedObject(const String& arrengementDescriptor);

	void removeSlottedObject(int index);

	int getContainerObjectsSize();

	int getSlottedObjectsSize();

	bool hasFullContainerObjects();

	unsigned int getContainerVolumeLimit();

	SceneObject* getContainerObject(int idx);

	VectorMap<unsigned long long, ManagedReference<SceneObject* > >* getContainerObjects();

	bool hasObjectInContainer(unsigned long long objectID);

	bool hasObjectInSlottedContainer(SceneObject* object);

	SceneObject* getContainerObject(unsigned long long objectID);

	void removeAllContainerObjects();

	void putInContainer(SceneObject* obj, unsigned long long key);

	void removeFromContainerObjects(int index);

	void setContainerVolumeLimit(int lim);

	void setContainerType(int type);

	unsigned int getContainerType();

	ZoneClientSession* getClient();

	unsigned int getGameObjectType();

	unsigned int getClientGameObjectType();

	unsigned int getContainmentType();

	float getDirectionAngle();

	float getSpecialDirectionAngle();

	void rotate(int degrees);

	void faceObject(SceneObject* obj);

	void notifySelfPositionUpdate();

	void notifyPositionUpdate(QuadTreeEntry* entry);

	void notifyCloseContainer(CreatureObject* player);

	unsigned int getMovementCounter();

	SceneObject* getParent();

	ZoneServer* getZoneServer();

	SceneObject* getRootParent();

	SceneObject* getParentRecursively(unsigned int gameObjectType);

	bool isASubChildOf(SceneObject* object);

	UnicodeString getCustomObjectName();

	String getLoggingName();

	bool isPlayerCreature();

	bool isVendor();

	ZoneComponent* getZoneComponent();

	ObjectMenuComponent* getObjectMenuComponent();

	bool isContainerFull();

	bool isShuttleInstallation();

	bool isPlayerObject();

	bool isActiveArea();

	bool isRegion();

	bool isCreatureObject();

	bool isVehicleObject();

	bool isBuildingObject();

	bool isCloningBuildingObject();

	bool isGarage();

	bool isWeaponObject();

	bool isWearableObject();

	bool isArmorObject();

	bool isPsgArmorObject();

	bool isCellObject();

	bool isTangibleObject();

	bool isResourceContainer();

	bool isComponent();

	bool isIntangibleObject();

	bool isInstrument();

	bool isInstallationObject();

	bool isCityTerminal();

	bool isCityVoteTerminal();

	bool isFactory();

	bool isFactoryCrate();

	bool isFishingPoleObject();

	bool isDeedObject();

	bool isVehicleDeedObject();

	bool isBuildingDeed();

	bool isSignObject();

	bool isInstallationDeed();

	bool isCraftingTool();

	bool isCraftingStation();

	bool isManufactureSchematic();

	bool isStructureObject();

	bool isFishingBait();

	bool isAttachment();

	void setGameObjectType(unsigned int type);

	void setClientObjectCRC(unsigned int objCRC);

	void setServerObjectCRC(unsigned int objCRC);

	void setParent(SceneObject* par);

	void setZoneProcessServer(ZoneProcessServer* srv);

	void setZone(Zone* zone);

	void setObjectName(StringId& stringID);

	void setDirection(float fw, float fx, float fy, float fz);

	void setDirection(float headingAngleRadians);

	void setDirection(const Quaternion& dir);

	void setMovementCounter(unsigned int count);

	void incrementMovementCounter();

	void setContainmentType(unsigned int type);

	void setLoggingName(const String& name);

	void setClientObject(bool val);

	unsigned int getPlanetCRC();

	bool isStaticObject();

	bool isContainerObject();

	bool isTerminal();

	bool isGroupObject();

	bool isGuildObject();

	bool isControlDevice();

	bool isMissionTerminal();

	bool isMissionObject();

	int getPlanetMapCategoryCRC();

	int getPlanetMapSubCategoryCRC();

	void setPlanetMapCategory(PlanetMapCategory* pmc);

	void setPlanetMapSubCategory(PlanetMapCategory* pmc);

	PlanetMapCategory* getPlanetMapCategory();

	PlanetMapCategory* getPlanetMapSubCategory();

	SortedVector<ManagedReference<SceneObject* > >* getChildObjects();

	bool containsChildObject(SceneObject* obj);

	SortedVector<ManagedReference<SceneObject* > >* getNotifiedSentObjects();

	SharedObjectTemplate* getObjectTemplate();

	void createChildObjects();

	void initializeChildObject(SceneObject* controllerObject);

	DistributedObjectServant* _getImplementation();

	void _setImplementation(DistributedObjectServant* servant);

protected:
	SceneObject(DummyConstructorParameter* param);

	virtual ~SceneObject();

	String _return_getArrangementDescriptor;
	String _return_getDetailedDescription;
	String _return_getLoggingName;
	String _return_getObjectNameStringIdFile;
	String _return_getObjectNameStringIdName;
	String _return_getSlotDescriptor;

	UnicodeString _return_getCustomObjectName;

	friend class SceneObjectHelper;
};

} // namespace scene
} // namespace objects
} // namespace zone
} // namespace server

using namespace server::zone::objects::scene;

namespace server {
namespace zone {
namespace objects {
namespace scene {

class SceneObjectImplementation : public QuadTreeEntryImplementation, public Logger {
protected:
	ManagedReference<ZoneProcessServer* > server;

	Reference<ZoneComponent* > zoneComponent;

	Reference<ObjectMenuComponent* > objectMenuComponent;

	Reference<ContainerComponent* > containerComponent;

	VectorMap<String, ManagedReference<SceneObject* > > slottedObjects;

	VectorMap<unsigned long long, ManagedReference<SceneObject* > > containerObjects;

	unsigned int containerType;

	unsigned int containerVolumeLimit;

	ZoneReference zone;

	ManagedWeakReference<CityRegion* > cityRegion;

	SortedVector<ManagedReference<ActiveArea* > > activeAreas;

	SortedVector<ManagedReference<SceneObject* > > notifiedSentObjects;

	ManagedWeakReference<SceneObject* > parent;

	SortedVector<ManagedReference<SceneObject* > > childObjects;

	unsigned int serverObjectCRC;

	unsigned int clientObjectCRC;

	Quaternion direction;

	unsigned int movementCounter;

	StringId objectName;

	PendingTasksMap pendingTasks;

	bool staticObject;

	VectorMap<unsigned int, ManagedReference<Facade* > > objectActiveSessions;

	unsigned int gameObjectType;

	unsigned int clientGameObjectType;

	unsigned int containmentType;

	int planetMapCategory;

	int planetMapSubCategory;

	Reference<SharedObjectTemplate* > templateObject;

public:
	static const int CELLOBJECT = 11;

	static const int PLAYEROBJECT = 12;

	static const int GROUPOBJECT = 0x02;

	static const int GUILDOBJECT = 0x03;

	static const int GENERALTANGIBLEOBJECT = 4;

	static const int STATICOBJECT = 5;

	static const int VENDORTERMINAL = 7;

	static const int ARMOR = 0x100;

	static const int BODYARMOR = 0x101;

	static const int HEADARMOR = 0x102;

	static const int MISCARMOR = 0x103;

	static const int LEGARMOR = 0x104;

	static const int ARMARMOR = 0x105;

	static const int HANDARMOR = 0x106;

	static const int FOOTARMOR = 0x107;

	static const int SHIELDGENERATOR = 0x108;

	static const int BUILDING = 0x200;

	static const int MUNICIPALBUILDING = 0x201;

	static const int FACTIONPERKBUILDING = 0x203;

	static const int TUTORIALBUILDING = 0x204;

	static const int MEDICALBUILDING = 0x205;

	static const int RECREATIONBUILDING = 0x206;

	static const int CLONINGBUILDING = 0x207;

	static const int TRAVELBUILDING = 0x208;

	static const int STARPORTBUILDING = 0x209;

	static const int CAPITOLBUILDING = 0x20A;

	static const int HOTELBUILDING = 0x20B;

	static const int THEATERBUILDING = 0x20C;

	static const int COMBATBUILDING = 0x20D;

	static const int COMMERCEBUILDING = 0x20E;

	static const int UNIVERSITYBUILDING = 0x20F;

	static const int GARAGEBUILDING = 0x210;

	static const int CITYHALLBUILDING = 0x211;

	static const int SALONBUILDING = 0x212;

	static const int CREATURE = 0x400;

	static const int NPCCREATURE = 0x401;

	static const int DROIDCREATURE = 0x402;

	static const int PROBOTCREATURE = 0x403;

	static const int PLAYERCREATURE = 0x409;

	static const int TRAINERCREATURE = 0x40A;

	static const int JUNKDEALERCREATURE = 0x40C;

	static const int INFORMANTCREATURE = 0x40D;

	static const int VENDORCREATURE = 0x40E;

	static const int INTANGIBLE = 0x800;

	static const int DRAFTSCHEMATIC = 0x801;

	static const int MANUFACTURINGSCHEMATIC = 0x802;

	static const int MISSIONOBJECT = 0x803;

	static const int TOKEN = 0x804;

	static const int WAYPOINT = 0x805;

	static const int DATA2 = 0x806;

	static const int PETCONTROLDEVICE = 0x807;

	static const int VEHICLECONTROLDEVICE = 0x808;

	static const int SHIPCONTROLDEVICE = 0x80A;

	static const int DROIDCONTROLDEVICE = 0x80B;

	static const int INSTALLATION = 0x1000;

	static const int FACTORY = 0x1001;

	static const int GENERATOR = 0x1002;

	static const int HARVESTER = 0x1003;

	static const int TURRET = 0x1004;

	static const int MINEFIELD = 0x1005;

	static const int GARAGEINSTALLATION = 0x1006;

	static const int SHUTTLEINSTALLATION = 0x1007;

	static const int TANGIBLE = 0x2000;

	static const int AMMUNITION = 0x2001;

	static const int CHEMICAL = 0x2002;

	static const int CONTAINER = 0x2005;

	static const int CRAFTINGSTATION = 0x2006;

	static const int ELECTRONICS = 0x2008;

	static const int FLORA = 0x2009;

	static const int FOOD = 0x200A;

	static const int FURNITURE = 0x200B;

	static const int INSTRUMENT = 0x200C;

	static const int PHARMACEUTICAL = 0x200D;

	static const int SIGN = 0x200F;

	static const int COUNTER = 0x2010;

	static const int FACTORYCRATE = 0x2011;

	static const int TRAVELTICKET = 0x2012;

	static const int GENERICITEM = 0x2013;

	static const int TRAP = 0x2014;

	static const int WEARABLECONTAINER = 0x2015;

	static const int FISHINGPOLE = 0x2016;

	static const int FISHINGBAIT = 0x2017;

	static const int DRINK = 0x2018;

	static const int FIREWORK = 0x2019;

	static const int ITEM = 0x201A;

	static const int PETMEDECINE = 0x201B;

	static const int FIREWORKSHOW = 0x201C;

	static const int CLOTHINGATTACHMENT = 0x201D;

	static const int LIVESAMPLE = 0x201E;

	static const int ARMORATTACHMENT = 0x201F;

	static const int COMMUNITYCRAFTINGPROJECT = 0x2020;

	static const int CRYSTAL = 0x2021;

	static const int DROIDPROGRAMMINGCHIP = 0x2022;

	static const int ASTEROID = 0x2023;

	static const int PILOTCHAIR = 0x2024;

	static const int OPERATIONSCHAIR = 0x2025;

	static const int TURRETACCESSLADDER = 0x2026;

	static const int CONTAINER2 = 0x2027;

	static const int CAMOKIT = 0x2028;

	static const int LOOTKIT = 0x2029;

	static const int FISH = 0x202A;

	static const int LAIR = 0x202B;

	static const int STIMPACK = 0x202C;

	static const int RANGEDSTIMPACK = 0x202D;

	static const int ENHANCEPACK = 0x202E;

	static const int CUREPACK = 0x202F;

	static const int DOTPACK = 0x2030;

	static const int WOUNDPACK = 0x2031;

	static const int STATEPACK = 0x2032;

	static const int REVIVEPACK = 0x2033;

	static const int STATICLOOTCONTAINER = 0x2034;

	static const int PLAYERLOOTCRATE = 0x2035;

	static const int TERMINAL = 0x4000;

	static const int BANK = 0x4001;

	static const int BAZAAR = 0x4002;

	static const int CLONING = 0x4003;

	static const int INSURANCE = 0x4004;

	static const int MISSIONTERMINAL = 0x4006;

	static const int PLAYERTERMINALSTRUCTURE = 0x4008;

	static const int SHIPPINGTERMINAL = 0x4009;

	static const int SPACETERMINAL = 0x400B;

	static const int INTERACTIVETERMINAL = 0x400C;

	static const int NEWBIETUTORIALTERMINAL = 0x400F;

	static const int CHARACTERBUILDERTERMINAL = 0x4010;

	static const int TICKETCOLLECTOR = 0x4011;

	static const int TRAVELTERMINAL = 0x4012;

	static const int ELEVATORTERMINAL = 0x4013;

	static const int GUILDTERMINAL = 0x4014;

	static const int CITYTERMINAL = 0x4015;

	static const int CITYVOTETERMINAL = 0x4016;

	static const int GAMBLINGTERMINAL = 0x4017;

	static const int TOOL = 0x8000;

	static const int CRAFTINGTOOL = 0x8001;

	static const int SURVEYTOOL = 0x8002;

	static const int REPAIRTOOL = 0x8003;

	static const int CAMPKIT = 0x8004;

	static const int SHIPCOMPONENTREPAIRITEM = 0x8005;

	static const int SLICINGTOOL = 0x8006;

	static const int MOLECULARCLAMP = 0x8007;

	static const int FLOWANALYZER = 0x8008;

	static const int LASERKNIFE = 0x8009;

	static const int WEAPONUPGRADEKIT = 0x800A;

	static const int ARMORUPGRADEKIT = 0x800B;

	static const int VEHICLE = 0x10000;

	static const int HOVERVEHICLE = 0x10001;

	static const int WEAPON = 0x20000;

	static const int MELEEWEAPON = 0x20001;

	static const int RANGEDWEAPON = 0x20002;

	static const int THROWNWEAPON = 0x20003;

	static const int HEAVYWEAPON = 0x20004;

	static const int MINE = 0x20005;

	static const int SPECIALHEAVYWEAPON = 0x20006;

	static const int ONEHANDMELEEWEAPON = 0x20007;

	static const int TWOHANDMELEEWEAPON = 0x20008;

	static const int POLEARM = 0x20009;

	static const int PISTOL = 0x2000A;

	static const int CARBINE = 0x2000B;

	static const int RIFLE = 0x2000C;

	static const int GRENADE = 0x2000E;

	static const int LIGHTNINGRIFLE = 0x2000F;

	static const int COMPONENT = 0x40000;

	static const int ARMORCOMPONENT = 0x40001;

	static const int CHEMISTRYCOMPONENT = 0x40002;

	static const int CLOTHINGCOMPONENT = 0x40003;

	static const int COMMUNITYCRAFTINGCOMPONENT = 0x40004;

	static const int DROIDCOMPONENT = 0x40005;

	static const int ELECTRONICSCOMPONENT = 0x40006;

	static const int GENETICCOMPONENT = 0x40007;

	static const int LIGHTSABERCRYSTAL = 0x40008;

	static const int MELEEWEAPONCOMPONENT = 0x40009;

	static const int MUNITIONCOMPONENT = 0x4000A;

	static const int RANGEDWEAPONCOMPONENT = 0x4000B;

	static const int STRUCTURECOMPONENT = 0x4000C;

	static const int TISSUECOMPONENT = 0x4000D;

	static const int WEAPONPOWERUP = 0x80000;

	static const int MELEEWEAPONPOWERUP = 0x80001;

	static const int RANGEDWEAPONPOWERUP = 0x80002;

	static const int THROWNWEAPONPOWERUP = 0x80003;

	static const int HEAVYWEAPONPOWERUP = 0x80004;

	static const int MINEPOWERUP = 0x80005;

	static const int SPECIALHEAVYWEAPONPOWERUP = 0x80006;

	static const int WEARABLE = 0x200000;

	static const int RING = 0x200001;

	static const int BRACELET = 0x200002;

	static const int NECKLACE = 0x200003;

	static const int EARRING = 0x200004;

	static const int RESOURCECONTAINER = 0x400000;

	static const int ENERGYGAS = 0x400001;

	static const int ENERGYLIQUID = 0x400002;

	static const int ENERGYRADIOACTIVE = 0x400003;

	static const int ENERGYSOLID = 0x400004;

	static const int INORGANICCHEMICAL = 0x400005;

	static const int INORGANICGAS = 0x400006;

	static const int INORGANICMINERAL = 0x400007;

	static const int WATER = 0x400008;

	static const int ORGANICFOOD = 0x400009;

	static const int ORGANICHIDE = 0x40000A;

	static const int ORGANICSTRUCTURAL = 0x40000B;

	static const int QUESTREOURCE = 0x40000C;

	static const int RESOURCESPAWN = 0x410000;

	static const int DEED = 0x800000;

	static const int BUILDINGDEED = 0x800001;

	static const int INSTALLATIONDEED = 0x800002;

	static const int PETDEED = 0x800003;

	static const int DROIDDEED = 0x800004;

	static const int VEHICLEDEED = 0x800005;

	static const int RESOURCEDEED = 0x800006;

	static const int CLOTHING = 0x1000000;

	static const int BANDOLIER = 0x1000001;

	static const int BELT = 0x1000002;

	static const int BODYSUIT = 0x1000003;

	static const int CAPE = 0x1000004;

	static const int CLOAK = 0x1000005;

	static const int FOOTWEAR = 0x1000006;

	static const int DRESS = 0x1000007;

	static const int HANDWEAR = 0x1000008;

	static const int EYEWEAR = 0x1000009;

	static const int HEADWEAR = 0x100000A;

	static const int JACKET = 0x100000B;

	static const int PANTS = 0x100000C;

	static const int ROBE = 0x100000D;

	static const int SHIRT = 0x100000E;

	static const int VEST = 0x100000F;

	static const int WOOKIEGARB = 0x1000010;

	static const int MISCCLOTHING = 0x1000011;

	static const int SKIRT = 0x1000012;

	static const int ITHOGARB = 0x1000013;

	static const int BADGEAREA = 0x2000000;

	static const int REGIONAREA = 0x2000001;

	static const int MISSIONSPAWNAREA = 0x2000002;

	static const int MISSIONRECONAREA = 0x2000003;

	static const int DYNAMICSPAWNAREA = 0x2000004;

	static const int STATICSPAWNAREA = 0x2000005;

	static const int GARAGEAREA = 0x2000006;

	static const int ACTIVEAREA = 0x2000007;

	static const int AIGROUP = 0x4000000;

	static const int HERDGROUP = 0x4000001;

	static const int PACKGROUP = 0x4000002;

	static const int LAIRGROUP = 0x4000003;

	static const int SHIP = 0x20000000;

	static const int SHIPFIGHTER = 0x20000001;

	static const int SHIPCAPITAL = 0x20000002;

	static const int SHIPSTATION = 0x20000003;

	static const int SHIPTRANSPORT = 0x20000004;

	static const int SHIPATTACHMENT = 0x40000000;

	static const int SHIPREACTOR = 0x40000001;

	static const int SHIPENGINE = 0x40000002;

	static const int SHIPSHIELDGENERATOR = 0x40000003;

	static const int SHIPARMOR = 0x40000004;

	static const int SHIPWEAPON = 0x40000005;

	static const int SHIPWEAPONCAPACITOR = 0x40000006;

	static const int SHIPBOOSTER = 0x40000007;

	static const int SHIPDRIODINTERFACE = 0x40000008;

	static const int SHIPCHASSIS = 0x4000000C;

	static const int SHIPMISSILE = 0x4000000D;

	static const int SHIPCOUNTERMEASURE = 0x4000000E;

	static const int SHIPWEAPONLAUNCHER = 0x4000000F;

	static const int SHIPCOUNTERMEASURELAUNCHER = 0x40000010;

	SceneObjectImplementation();

	SceneObjectImplementation(DummyConstructorParameter* param);

	void finalize();

	void initializePrivateData();

	virtual void loadTemplateData(SharedObjectTemplate* templateData);

	virtual void createComponents();

	virtual void createContainerComponent();

	void initializeTransientMembers();

	virtual void notifyLoadFromDatabase();

	void info(const String& msg, bool forced = false);

	void error(const String& msg);

	int inRangeObjects(unsigned int gameObjectType, float range);

	bool isInRange(SceneObject* obj, float range);

	virtual bool addObject(SceneObject* object, int containmentType, bool notifyClient = false);

	virtual bool removeObject(SceneObject* object, bool notifyClient = false);

	virtual int canAddObject(SceneObject* object, int containmentType, String& errorDescription);

	virtual void synchronizedUIListen(SceneObject* player, int value);

	virtual void synchronizedUIStopListen(SceneObject* player, int value);

	void updateToDatabase();

	void updateToDatabaseWithoutChildren();

	void updateToDatabaseAllObjects(bool startTask);

	virtual void destroyObjectFromDatabase(bool destroyContainedObjects = false);

	virtual int canBeDestroyed(CreatureObject* player);

	void create(ZoneClientSession* client);

	void destroy(ZoneClientSession* client);

	void close(ZoneClientSession* client);

	void link(ZoneClientSession* client, unsigned int containmentType = 4);

	BaseMessage* link(unsigned long long objectID, unsigned int containmentType = 4);

	virtual void sendTo(SceneObject* player, bool doClose);

	virtual void sendWithoutParentTo(SceneObject* player);

	virtual void sendWithoutContainerObjectsTo(SceneObject* player);

	virtual void sendDestroyTo(SceneObject* player);

	virtual void sendBaselinesTo(SceneObject* player);

	virtual void sendContainerObjectsTo(SceneObject* player);

	virtual void sendSlottedObjectsTo(SceneObject* player);

	virtual void sendToOwner(bool doClose = true);

	virtual void sendAttributeListTo(CreatureObject* object);

	virtual void fillAttributeList(AttributeListMessage* msg, CreatureObject* object);

	virtual void setCustomObjectName(const UnicodeString& name, bool notifyClient);

	virtual void fillObjectMenuResponse(ObjectMenuResponse* menuResponse, CreatureObject* player);

	virtual void openContainerTo(CreatureObject* player);

	virtual void closeContainerTo(CreatureObject* player, bool notify = true);

	virtual void insertToZone(Zone* zone);

	virtual void insertToBuilding(BuildingObject* building);

	virtual void switchZone(const String& newTerrainName, float newPostionX, float newPositionZ, float newPositionY, unsigned long long parentID = 0);

	virtual void teleport(float newPositionX, float newPositionZ, float newPositionY, unsigned long long parentID = 0);

	void updateDirection(float fw, float fx, float fy, float fz);

	void notifyInsert(QuadTreeEntry* entry);

	void notifyDissapear(QuadTreeEntry* entry);

	virtual void removeFromZone();

	virtual void removeFromBuilding(BuildingObject* building);

	virtual void updateZone(bool lightUpdate, bool sendPackets = true);

	virtual void updateZoneWithParent(SceneObject* newParent, bool lightUpdate, bool sendPackets = true);

	void broadcastMessage(BasePacket* message, bool sendSelf, bool lockZone = true);

	void broadcastObject(SceneObject* object, bool sendSelf);

	void broadcastDestroy(SceneObject* object, bool sendSelf);

	void broadcastMessages(Vector<BasePacket*>* messages, bool sendSelf);

	virtual void sendMessage(BasePacket* msg);

	int compareTo(SceneObject* obj);

	void getSlottedObjects(VectorMap<String, ManagedReference<SceneObject* > >& objects);

	unsigned long long getParentID();

	void addPendingTask(const String& name, Task* task);

	void removePendingTask(const String& name);

	Task* getPendingTask(const String& name);

	void showFlyText(const String& file, const String& uax, byte red, byte green, byte blue);

	Facade* getActiveSession(unsigned int type);

	void addActiveSession(unsigned int type, Facade* session);

	bool containsActiveSession(unsigned int type);

	bool dropActiveSession(unsigned int type);

	int getActiveSessionsCount();

	VectorMap<unsigned int, ManagedReference<Facade* > >* getObjectActiveSessions();

	virtual int handleObjectMenuSelect(CreatureObject* player, byte selectedID);

	void notifyAddedToCloseObjects();

	void notifyRemovedFromCloseObjects();

	float getDistanceTo(SceneObject* object);

	float getDistanceTo(Coordinate* coordinate);

	void updateVehiclePosition();

	virtual int notifyObjectInserted(SceneObject* object);

	virtual int notifyObjectRemoved(SceneObject* object);

	bool hasNotifiedSentObject(SceneObject* object);

	int addNotifiedSentObject(SceneObject* object);

	void removeNotifiedSentObject(SceneObject* object);

	void addActiveArea(ActiveArea* area);

	void dropActiveArea(ActiveArea* area);

	bool hasActiveArea(ActiveArea* area);

	Vector<ManagedReference<ActiveArea* > >* getActiveAreas();

	int getActiveAreasSize();

	ActiveArea* getActiveRegion();

	CityRegion* getCityRegion();

	void setCityRegion(CityRegion* region);

	Zone* getZone();

	unsigned long long getObjectID();

	Vector3 getCoordinate(float distance, float angleDegrees);

	float getWorldPositionX();

	float getWorldPositionY();

	float getWorldPositionZ();

	Vector3 getWorldPosition();

	float getDirectionX();

	float getDirectionZ();

	float getDirectionY();

	float getDirectionW();

	Quaternion* getDirection();

	unsigned int getClientObjectCRC();

	unsigned int getServerObjectCRC();

	bool isWaypointObject();

	StringId* getObjectName();

	String getObjectNameStringIdFile();

	String getObjectNameStringIdName();

	String getDetailedDescription();

	int getArrangementDescriptorSize();

	String getArrangementDescriptor(int idx);

	String getSlotDescriptor(int idx);

	bool hasSlotDescriptor(const String& descr);

	VectorMap<String, ManagedReference<SceneObject* > >* getSlottedObjects();

	SceneObject* getSlottedObject(const String& slot);

	int getSlotDescriptorSize();

	SceneObject* getSlottedObject(int idx);

	void dropSlottedObject(const String& arrengementDescriptor);

	void removeSlottedObject(int index);

	int getContainerObjectsSize();

	int getSlottedObjectsSize();

	bool hasFullContainerObjects();

	unsigned int getContainerVolumeLimit();

	SceneObject* getContainerObject(int idx);

	VectorMap<unsigned long long, ManagedReference<SceneObject* > >* getContainerObjects();

	bool hasObjectInContainer(unsigned long long objectID);

	bool hasObjectInSlottedContainer(SceneObject* object);

	SceneObject* getContainerObject(unsigned long long objectID);

	void removeAllContainerObjects();

	void putInContainer(SceneObject* obj, unsigned long long key);

	void removeFromContainerObjects(int index);

	void setContainerVolumeLimit(int lim);

	void setContainerType(int type);

	unsigned int getContainerType();

	virtual ZoneClientSession* getClient();

	unsigned int getGameObjectType();

	unsigned int getClientGameObjectType();

	unsigned int getContainmentType();

	float getDirectionAngle();

	float getSpecialDirectionAngle();

	void rotate(int degrees);

	void faceObject(SceneObject* obj);

	virtual void notifySelfPositionUpdate();

	void notifyPositionUpdate(QuadTreeEntry* entry);

	virtual void notifyCloseContainer(CreatureObject* player);

	unsigned int getMovementCounter();

	SceneObject* getParent();

	ZoneServer* getZoneServer();

	SceneObject* getRootParent();

	SceneObject* getParentRecursively(unsigned int gameObjectType);

	bool isASubChildOf(SceneObject* object);

	UnicodeString getCustomObjectName();

	String getLoggingName();

	virtual bool isPlayerCreature();

	virtual bool isVendor();

	ZoneComponent* getZoneComponent();

	ObjectMenuComponent* getObjectMenuComponent();

	bool isContainerFull();

	bool isShuttleInstallation();

	bool isPlayerObject();

	virtual bool isActiveArea();

	virtual bool isRegion();

	virtual bool isCreatureObject();

	virtual bool isVehicleObject();

	virtual bool isBuildingObject();

	virtual bool isCloningBuildingObject();

	bool isGarage();

	virtual bool isWeaponObject();

	virtual bool isWearableObject();

	virtual bool isArmorObject();

	virtual bool isPsgArmorObject();

	virtual bool isCellObject();

	virtual bool isTangibleObject();

	virtual bool isResourceContainer();

	virtual bool isComponent();

	virtual bool isIntangibleObject();

	bool isInstrument();

	virtual bool isInstallationObject();

	virtual bool isCityTerminal();

	virtual bool isCityVoteTerminal();

	virtual bool isFactory();

	virtual bool isFactoryCrate();

	bool isFishingPoleObject();

	virtual bool isDeedObject();

	virtual bool isVehicleDeedObject();

	virtual bool isBuildingDeed();

	virtual bool isSignObject();

	virtual bool isInstallationDeed();

	virtual bool isCraftingTool();

	virtual bool isCraftingStation();

	virtual bool isManufactureSchematic();

	virtual bool isStructureObject();

	bool isFishingBait();

	virtual bool isAttachment();

	void setGameObjectType(unsigned int type);

	void setClientObjectCRC(unsigned int objCRC);

	void setServerObjectCRC(unsigned int objCRC);

	void setParent(SceneObject* par);

	void setZoneProcessServer(ZoneProcessServer* srv);

	void setZone(Zone* zone);

	void setObjectName(StringId& stringID);

	void setDirection(float fw, float fx, float fy, float fz);

	void setDirection(float headingAngleRadians);

	void setDirection(const Quaternion& dir);

	void setMovementCounter(unsigned int count);

	void incrementMovementCounter();

	void setContainmentType(unsigned int type);

	void setLoggingName(const String& name);

	void setClientObject(bool val);

	virtual unsigned int getPlanetCRC();

	bool isStaticObject();

	virtual bool isContainerObject();

	virtual bool isTerminal();

	virtual bool isGroupObject();

	virtual bool isGuildObject();

	virtual bool isControlDevice();

	virtual bool isMissionTerminal();

	virtual bool isMissionObject();

	int getPlanetMapCategoryCRC();

	int getPlanetMapSubCategoryCRC();

	void setPlanetMapCategory(PlanetMapCategory* pmc);

	void setPlanetMapSubCategory(PlanetMapCategory* pmc);

	PlanetMapCategory* getPlanetMapCategory();

	PlanetMapCategory* getPlanetMapSubCategory();

	SortedVector<ManagedReference<SceneObject* > >* getChildObjects();

	bool containsChildObject(SceneObject* obj);

	SortedVector<ManagedReference<SceneObject* > >* getNotifiedSentObjects();

	SharedObjectTemplate* getObjectTemplate();

	virtual void createChildObjects();

	virtual void initializeChildObject(SceneObject* controllerObject);

	WeakReference<SceneObject*> _this;

	operator const SceneObject*();

	DistributedObjectStub* _getStub();
	virtual void readObject(ObjectInputStream* stream);
	virtual void writeObject(ObjectOutputStream* stream);
protected:
	virtual ~SceneObjectImplementation();

	void _initializeImplementation();

	void _setStub(DistributedObjectStub* stub);

	void lock(bool doLock = true);

	void lock(ManagedObject* obj);

	void rlock(bool doLock = true);

	void wlock(bool doLock = true);

	void wlock(ManagedObject* obj);

	void unlock(bool doLock = true);

	void runlock(bool doLock = true);

	void _serializationHelperMethod();
	bool readObjectMember(ObjectInputStream* stream, const String& name);
	int writeObjectMembers(ObjectOutputStream* stream);

	friend class SceneObject;
};

class SceneObjectAdapter : public QuadTreeEntryAdapter {
public:
	SceneObjectAdapter(SceneObjectImplementation* impl);

	Packet* invokeMethod(sys::uint32 methid, DistributedMethod* method);

	void finalize();

	void initializePrivateData();

	void createComponents();

	void createContainerComponent();

	void initializeTransientMembers();

	void notifyLoadFromDatabase();

	void info(const String& msg, bool forced);

	void error(const String& msg);

	int inRangeObjects(unsigned int gameObjectType, float range);

	bool isInRange(SceneObject* obj, float range);

	bool addObject(SceneObject* object, int containmentType, bool notifyClient);

	bool removeObject(SceneObject* object, bool notifyClient);

	int canAddObject(SceneObject* object, int containmentType, String& errorDescription);

	void synchronizedUIListen(SceneObject* player, int value);

	void synchronizedUIStopListen(SceneObject* player, int value);

	void updateToDatabase();

	void updateToDatabaseWithoutChildren();

	void updateToDatabaseAllObjects(bool startTask);

	void destroyObjectFromDatabase(bool destroyContainedObjects);

	int canBeDestroyed(CreatureObject* player);

	void create(ZoneClientSession* client);

	void destroy(ZoneClientSession* client);

	void close(ZoneClientSession* client);

	void link(ZoneClientSession* client, unsigned int containmentType);

	BaseMessage* link(unsigned long long objectID, unsigned int containmentType);

	void sendTo(SceneObject* player, bool doClose);

	void sendWithoutParentTo(SceneObject* player);

	void sendWithoutContainerObjectsTo(SceneObject* player);

	void sendDestroyTo(SceneObject* player);

	void sendBaselinesTo(SceneObject* player);

	void sendContainerObjectsTo(SceneObject* player);

	void sendSlottedObjectsTo(SceneObject* player);

	void sendToOwner(bool doClose);

	void sendAttributeListTo(CreatureObject* object);

	void setCustomObjectName(const UnicodeString& name, bool notifyClient);

	void openContainerTo(CreatureObject* player);

	void closeContainerTo(CreatureObject* player, bool notify);

	void insertToZone(Zone* zone);

	void insertToBuilding(BuildingObject* building);

	void switchZone(const String& newTerrainName, float newPostionX, float newPositionZ, float newPositionY, unsigned long long parentID);

	void teleport(float newPositionX, float newPositionZ, float newPositionY, unsigned long long parentID);

	void updateDirection(float fw, float fx, float fy, float fz);

	void removeFromZone();

	void removeFromBuilding(BuildingObject* building);

	void updateZone(bool lightUpdate, bool sendPackets);

	void updateZoneWithParent(SceneObject* newParent, bool lightUpdate, bool sendPackets);

	void broadcastMessage(BasePacket* message, bool sendSelf, bool lockZone);

	void broadcastObject(SceneObject* object, bool sendSelf);

	void broadcastDestroy(SceneObject* object, bool sendSelf);

	void sendMessage(BasePacket* msg);

	int compareTo(SceneObject* obj);

	unsigned long long getParentID();

	void showFlyText(const String& file, const String& uax, byte red, byte green, byte blue);

	Facade* getActiveSession(unsigned int type);

	void addActiveSession(unsigned int type, Facade* session);

	bool containsActiveSession(unsigned int type);

	bool dropActiveSession(unsigned int type);

	int getActiveSessionsCount();

	int handleObjectMenuSelect(CreatureObject* player, byte selectedID);

	void notifyAddedToCloseObjects();

	void notifyRemovedFromCloseObjects();

	float getDistanceTo(SceneObject* object);

	void updateVehiclePosition();

	int notifyObjectInserted(SceneObject* object);

	int notifyObjectRemoved(SceneObject* object);

	bool hasNotifiedSentObject(SceneObject* object);

	int addNotifiedSentObject(SceneObject* object);

	void removeNotifiedSentObject(SceneObject* object);

	void addActiveArea(ActiveArea* area);

	void dropActiveArea(ActiveArea* area);

	bool hasActiveArea(ActiveArea* area);

	int getActiveAreasSize();

	ActiveArea* getActiveRegion();

	CityRegion* getCityRegion();

	void setCityRegion(CityRegion* region);

	Zone* getZone();

	unsigned long long getObjectID();

	float getWorldPositionX();

	float getWorldPositionY();

	float getWorldPositionZ();

	float getDirectionX();

	float getDirectionZ();

	float getDirectionY();

	float getDirectionW();

	unsigned int getClientObjectCRC();

	unsigned int getServerObjectCRC();

	bool isWaypointObject();

	String getObjectNameStringIdFile();

	String getObjectNameStringIdName();

	int getArrangementDescriptorSize();

	String getArrangementDescriptor(int idx);

	String getSlotDescriptor(int idx);

	bool hasSlotDescriptor(const String& descr);

	SceneObject* getSlottedObject(const String& slot);

	int getSlotDescriptorSize();

	SceneObject* getSlottedObject(int idx);

	void dropSlottedObject(const String& arrengementDescriptor);

	void removeSlottedObject(int index);

	int getContainerObjectsSize();

	int getSlottedObjectsSize();

	bool hasFullContainerObjects();

	unsigned int getContainerVolumeLimit();

	SceneObject* getContainerObject(int idx);

	bool hasObjectInContainer(unsigned long long objectID);

	bool hasObjectInSlottedContainer(SceneObject* object);

	SceneObject* getContainerObject(unsigned long long objectID);

	void removeAllContainerObjects();

	void putInContainer(SceneObject* obj, unsigned long long key);

	void removeFromContainerObjects(int index);

	void setContainerVolumeLimit(int lim);

	void setContainerType(int type);

	unsigned int getContainerType();

	ZoneClientSession* getClient();

	unsigned int getGameObjectType();

	unsigned int getClientGameObjectType();

	unsigned int getContainmentType();

	float getDirectionAngle();

	float getSpecialDirectionAngle();

	void rotate(int degrees);

	void faceObject(SceneObject* obj);

	void notifySelfPositionUpdate();

	void notifyPositionUpdate(QuadTreeEntry* entry);

	void notifyCloseContainer(CreatureObject* player);

	unsigned int getMovementCounter();

	SceneObject* getParent();

	ZoneServer* getZoneServer();

	SceneObject* getRootParent();

	SceneObject* getParentRecursively(unsigned int gameObjectType);

	bool isASubChildOf(SceneObject* object);

	UnicodeString getCustomObjectName();

	String getLoggingName();

	bool isPlayerCreature();

	bool isVendor();

	bool isContainerFull();

	bool isShuttleInstallation();

	bool isPlayerObject();

	bool isActiveArea();

	bool isRegion();

	bool isCreatureObject();

	bool isVehicleObject();

	bool isBuildingObject();

	bool isCloningBuildingObject();

	bool isGarage();

	bool isWeaponObject();

	bool isWearableObject();

	bool isArmorObject();

	bool isPsgArmorObject();

	bool isCellObject();

	bool isTangibleObject();

	bool isResourceContainer();

	bool isComponent();

	bool isIntangibleObject();

	bool isInstrument();

	bool isInstallationObject();

	bool isCityTerminal();

	bool isCityVoteTerminal();

	bool isFactory();

	bool isFactoryCrate();

	bool isFishingPoleObject();

	bool isDeedObject();

	bool isVehicleDeedObject();

	bool isBuildingDeed();

	bool isSignObject();

	bool isInstallationDeed();

	bool isCraftingTool();

	bool isCraftingStation();

	bool isManufactureSchematic();

	bool isStructureObject();

	bool isFishingBait();

	bool isAttachment();

	void setGameObjectType(unsigned int type);

	void setClientObjectCRC(unsigned int objCRC);

	void setServerObjectCRC(unsigned int objCRC);

	void setParent(SceneObject* par);

	void setZone(Zone* zone);

	void setDirection(float fw, float fx, float fy, float fz);

	void setDirection(float headingAngleRadians);

	void setMovementCounter(unsigned int count);

	void incrementMovementCounter();

	void setContainmentType(unsigned int type);

	void setLoggingName(const String& name);

	void setClientObject(bool val);

	unsigned int getPlanetCRC();

	bool isStaticObject();

	bool isContainerObject();

	bool isTerminal();

	bool isGroupObject();

	bool isGuildObject();

	bool isControlDevice();

	bool isMissionTerminal();

	bool isMissionObject();

	int getPlanetMapCategoryCRC();

	int getPlanetMapSubCategoryCRC();

	bool containsChildObject(SceneObject* obj);

	void createChildObjects();

	void initializeChildObject(SceneObject* controllerObject);

protected:
	String _param0_info__String_bool_;
	String _param0_error__String_;
	String _param2_canAddObject__SceneObject_int_String_;
	UnicodeString _param0_setCustomObjectName__UnicodeString_bool_;
	String _param0_switchZone__String_float_float_float_long_;
	String _param0_showFlyText__String_String_byte_byte_byte_;
	String _param1_showFlyText__String_String_byte_byte_byte_;
	String _param0_hasSlotDescriptor__String_;
	String _param0_getSlottedObject__String_;
	String _param0_dropSlottedObject__String_;
	String _param0_setLoggingName__String_;
};

class SceneObjectHelper : public DistributedObjectClassHelper, public Singleton<SceneObjectHelper> {
	static SceneObjectHelper* staticInitializer;

public:
	SceneObjectHelper();

	void finalizeHelper();

	DistributedObject* instantiateObject();

	DistributedObjectServant* instantiateServant();

	DistributedObjectAdapter* createAdapter(DistributedObjectStub* obj);

	friend class Singleton<SceneObjectHelper>;
};

} // namespace scene
} // namespace objects
} // namespace zone
} // namespace server

using namespace server::zone::objects::scene;

#endif /*SCENEOBJECT_H_*/
